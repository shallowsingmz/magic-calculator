# 魔术计算器网页

## 一、项目概述
本项目是一个具有“魔术效果”的网页计算器，外观复刻 iOS 计算器，核心逻辑为：初始阶段功能正常，首次按等号记录结果，首次按等号后的首次清屏后，基于系统时间生成7位或8位数并暗中计算差值，随后通过点击网页任意位置逐位显示差值，只有显示完毕后才可点击清屏键清屏，清屏后计算器恢复正常功能。

## 二、外观设计
完全复刻 iOS 计算器的UI布局、比例、颜色、字体、动画，包括但不限于：
1. **显示区**：位于顶部，用于显示输入的计算式、输出的计算结果、差值的逐位显示内容。
2. **按键区**：包含数字键（0-9）、运算符号键（+、-、×、÷等）、等号键（=）、回退键（图案）、清屏键（AC/C，需明确清屏键的标识）。

## 三、核心功能逻辑（按状态顺序流转）
### 状态0：初始待命状态（页面加载完成后的初始状态）
- **功能表现**：
  1. 计算器功能基本正常，支持数字输入、运算符号选择、连续运算、清屏等正常功能。
  2. 显示区实时响应用户操作，显示输入的数字、运算式等。
  3. 显示逻辑和动画复刻 iOS 计算器即可。
- **状态流转触发**：用户点击“等号键”。

---

### 状态1：首次等号结果记录状态
- **功能表现**：
  1. 若用户在状态0中正常输入了运算式（仅输入数字不添加运算符号属于没有输入运算式）：计算器正常计算输入的运算式，将结果显示在显示区，系统后台记录该计算结果，记为变量 `R`（Result）。
  2. 若用户在状态0中没有输入运算式，直接点击了等号键：则直接将当前显示区的数字直接记为变量 `R`（Result）。
  3. 当变量 `R` 存在后，用户再点击网页任意位置（清屏键除外），显示区都不会有任何变化。
- **状态流转触发**：用户点击“清屏键”。

---

### 状态2：差值隐藏与逐位显示状态
- **功能表现**：
  1. **清屏操作**：显示区正常清空，显示“0”。
  2. **生成7位或8位数 `N`**：获取当前系统日期与时间，按“7位或8位数生成规则”（见下文）后台生成一个7位或8位整数，记为 `N`。
  3. **计算差值 `D`**：后台计算 `D = N - R`（若 `N < R`，则 `D = R - N`，确保差值为非负整数，便于逐位显示）。
  4. **隐藏差值**：差值 `D` 仅后台存储，不显示在显示区。
  5. ***特殊的优先情况（彩蛋）***：若 `D == 0`，则将 `R` 直接显示在显示区并转为绿色字体，然后完全锁定网页，暂停所有逻辑判断，禁止用户在网页中的任何操作（也就是只能刷新网页）。
  6. **初始化逻辑变量 `P`**：设置变量 `P = 0`。
- **逐位显示逻辑**：
  进入此状态后，用户**点击网页任意位置（包括清屏键、按键区、显示区、空白处等所有区域）**，触发以下操作：
  - 若 `P < D的总位数`：
    1. 取差值 `D` 的第 `P + 1` 位（从最高位开始计数）。
    2. 将取得的该位数字**追加**到显示区（例如 `D=7654321`，第一次点击显示 `7`，第二次点击显示 `76`，第三次显示 `765`，以此类推）。
    3. 变量 `P` 自增1（`P = P + 1`）。
    4. 等待用户下一次点击。
  - 若 `P == D的总位数`：触发状态流转，自动进入“状态3：差值显示完毕状态”。
- **状态流转触发**：指针 `P` 等于差值 `D` 的总位数。

---

### 状态3：差值显示完毕状态
- **功能表现**：
  1. 若**点击非清屏键区域**：用户点击网页任意位置（清屏键除外），显示区不会有任何变化，保持显示差值 `D`。
  2. 若**点击清屏键**：触发状态流转，自动进入“状态4：完全正常的计算器状态”。
- **状态流转触发**：点击“清屏键”。

---

### 状态4：完全正常的计算器状态（最终状态）
- **功能表现**：
  1. 显示区正常清空，显示“0”。
  2. 完全恢复到正常计算器的状态，用户可进行任意常规运算。
- **状态流转触发**：没有任何方式可以再触发流转（除非刷新网页）。

## 四、7位或8位数生成规则
基于当前系统日期与时间生成7位或8位整数 `N`，规则如下：
1. **提取时间组件**：
   - 月份（`M`）：取当前月份（1-12），若为1-9月，取1位数字（如2月→`2`）；若为10-12月，取2位数字（如10月→`10`）。
   - 日期（`Date`）：取当前日期（1-31），固定2位，不足补0（如6日→`06`，16日→`16`）。
   - 小时（`H`）：取当前小时（24小时制，0-23），固定2位，不足补0（如9点→`09`，22点→`22`）。
   - 分钟（`Min`）：取当前分钟（0-59），固定2位，不足补0（如5分→`05`，40分→`40`）。
2. **拼接与截取**：
   - 将时间组件按“月份→日期→小时→分钟”的顺序拼接成字符串 `timeStr`。
   - 示例：
     - 2月16日22:40 → 拼接为 `2162240`（长度7位） → `N = 2162240`。
     - 10月8日09:05 → 拼接为 `10080905`（长度8位） → `N = 10080905`。
     - 3月5日08:03 → 拼接为 `3050803`（长度7位） → `N = 3050803`。

## 五、技术栈
**仅使用 `html+css+js`，不使用 `node.js`、`React` 等。**
